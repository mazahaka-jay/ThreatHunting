// KQL hunt for:
// Phemedrone Stealer Campaign IOCs
union withsource=SourceTable  DeviceEvents, DeviceFileEvents, DeviceNetworkEvents
//https://xakep.ru/2024/01/16/phemedrone-windows-smartscreen/
//https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2023-36025
//list of iocs: https://documents.trendmicro.com/images/TEx/20240111-cve-2023%E2%80%9336025-phemedrone-iocs8L7B0q0.txt
//CVE-2023-36025 Exploited for Defense Evasion in Phemedrone Stealer Campaign
//match SHA256 of the malicious files 
| where SHA256 in~   ("f32964087462ba3c96a87ee8387f89de8fa605f2f5bb84cb5f754cd736683f2d", "5f1a027f1c1468f93671a4c7fc7b5da00a3c559a9116f5417baa6c1f89550d9f", "c6765d92e540af845b3cbc4caa4f9e9d00d5003a36c9cb548ea79bb14c7e8f66", "a841cd16062702462fdffdd7eef9fc3d88cde65d19c8d5a384e33066d65f9424", "815b2125d6f0a5d99750614731aaad2c6936a1dc107a969408a88973f35064c0", "ccd19ef6e81e936fc944ebafaefd2ad99ccd11dd15fbc7d3460726bb38237595", "ea9b0dee3b7583ce60bba277e2189acb660284abf6b3b9273b6a60c85b0a5ce3", "9a96406ae06b703d827fffd1f1ced0781f89ca2af6d5041721e9fbd2647c8430", "22236e50b5f700f5606788dcd5ab1fb69ee092e8dffdd783ac3cab47f1f445ab", "1433efd142007ce809aff5b057810f5a1919ea1e3ff740ff0fcc2fc729226be5", "ad513d2cba6cc82a50ee6531b275e937480d8fee20af2b4f41da5f88e408a4e9", "7c0a1e11610805bd187ef6e395c8fa31c1ae756962e26cdbff704ce54b9e678a", "4ae28a44c38edc516e449ddd269b5aa9924d549d763773dcd312b48fe6bb91ab", "c9743e7ffb6f6978f08f86e970ddb82e24920d266b32bd242254fbf51abfe6ce", "c3bfaa1f52abdbb673d83af67090112dfdfe9ea8ff7a613f62bd48bace205f75", "6bd8449de1e1bdd62a86284ed17266949654f758e00e10d8cd59ec4d233c32e5", "4446d5b475ce8aed5244da917ae42b6cb9744ffc4efd766af8e4dee7dd5a3e19", "70c23213096457df852b66443d9a632e66816e023fdf05a93b9087ffb753d916", "69941417f26c207f7cbbbe36ce8b4d976640a3d7f407d316932428e427f1980b", "e2d19a23b19a07d35d16990e78c5cfaa3dd97b9ce92201f4db18a7da95fe6ff8", "b7f53c507a1aa4254b66a883285e27b42d65ea4ea4206fe674e0d03738f52141", "4ae28a44c38edc516e449ddd269b5aa9924d549d763773dcd312b48fe6bb91ab", "c6765d92e540af845b3cbc4caa4f9e9d00d5003a36c9cb548ea79bb14c7e8f66", "f24a8b3144e89b9bececfbf76add87ddefbd19a024a85692026e97f3a9911902", "e64b185c149cb523d13cb46ea3911e2c0595b6f10ae86e6a14b15e8d45c0cdcb", "cb58bf466675be9e11cfb404503cb122514f47b9708d033e381f28a60535812c", "80f88566fda41ebc1b4e35d89748a804740bba0d03049c33c536cffd5e0491e2", "4a36cc607ca5c2acc536510fd1b0ddd43a9403dac168d2420d474611909ed9e6", "89caa1568fcff162086dae91e6bd34fd04facba50166ebff800d45a999d0be8b", "188c72f995ebd5e1e8d0e3b9d34eeeec2ec95d4d0fee30d2ea0f317ab1596eef", "e326c1b9e61cca6823300158e55381c6951b09d2327a89a8d841539cad3b4df3", "4da33c7fe62f71962913d7b40ff76aff9f1586e57db707b3d6b88162c051f402", "ff44e502bd5ea36e17b3fc39b480e65971b36002f27fb441e4acadd6bf604a20", "b7980f64f892d70b1cd72a8c80f8319f50c3c410aba4e4bc63fd6494bcb4f313", "480fae3bdc2604cba846779dd7dced95b3ce036bdef629ded247771a2e4d5d58", "348aea633c99e5f6a0ac7b850961be0a145a35678e5bd074b4852f7a2419f518", "1c53dffcb4c474a2b08708609466e7d234d6d51139b6532af54fac5bb8d37415", "b37ec923451dd15a0f68df0b392b0f1b243fe50c709de9e574ac14cf6fabdd53", "f2814a4b3796fb44045c33b9d0d9972bf40478e5bc74b587486900c6cfa02f3d", "5f1a027f1c1468f93671a4c7fc7b5da00a3c559a9116f5417baa6c1f89550d9f", "8b73d7aa8bb8db8a9ecbf9f713934fbbb5caf4745d7a61a6f34a100c4d84fd9d", "9b9ba722b314febfc44919551a03dde1539f115333183c2cb5e74b8e644ba5b3", "568b4b868b225f06bb34da0dc23603c9dedccc2b319353407c814983d5322563", "5ecad303475e180f8879871d8571d1a7eeb99e0b3c63cc77fdd02cb9b8c51211", "d5b1214f1817a16b2bc8a76daa48c9a3c5af0e411cf4f0c17b0e364d437a454b", "5f0ff1fd6ca89a0ddd3178e023dea8f79ff3c3f3d8ff7900378eb014e83ed326", "40c6fa38e44e00d8cf113d0a079cd46f8b7654331f12e50d2af5a9f1ddc6d266", "3a34cd3a3221d83a1cca8913b2afbb5b780027d48b44d3ce15dfe4a402064871") 
or InitiatingProcessSHA256 in~ ("f32964087462ba3c96a87ee8387f89de8fa605f2f5bb84cb5f754cd736683f2d", "5f1a027f1c1468f93671a4c7fc7b5da00a3c559a9116f5417baa6c1f89550d9f", "c6765d92e540af845b3cbc4caa4f9e9d00d5003a36c9cb548ea79bb14c7e8f66", "a841cd16062702462fdffdd7eef9fc3d88cde65d19c8d5a384e33066d65f9424", "815b2125d6f0a5d99750614731aaad2c6936a1dc107a969408a88973f35064c0", "ccd19ef6e81e936fc944ebafaefd2ad99ccd11dd15fbc7d3460726bb38237595", "ea9b0dee3b7583ce60bba277e2189acb660284abf6b3b9273b6a60c85b0a5ce3", "9a96406ae06b703d827fffd1f1ced0781f89ca2af6d5041721e9fbd2647c8430", "22236e50b5f700f5606788dcd5ab1fb69ee092e8dffdd783ac3cab47f1f445ab", "1433efd142007ce809aff5b057810f5a1919ea1e3ff740ff0fcc2fc729226be5", "ad513d2cba6cc82a50ee6531b275e937480d8fee20af2b4f41da5f88e408a4e9", "7c0a1e11610805bd187ef6e395c8fa31c1ae756962e26cdbff704ce54b9e678a", "4ae28a44c38edc516e449ddd269b5aa9924d549d763773dcd312b48fe6bb91ab", "c9743e7ffb6f6978f08f86e970ddb82e24920d266b32bd242254fbf51abfe6ce", "c3bfaa1f52abdbb673d83af67090112dfdfe9ea8ff7a613f62bd48bace205f75", "6bd8449de1e1bdd62a86284ed17266949654f758e00e10d8cd59ec4d233c32e5", "4446d5b475ce8aed5244da917ae42b6cb9744ffc4efd766af8e4dee7dd5a3e19", "70c23213096457df852b66443d9a632e66816e023fdf05a93b9087ffb753d916", "69941417f26c207f7cbbbe36ce8b4d976640a3d7f407d316932428e427f1980b", "e2d19a23b19a07d35d16990e78c5cfaa3dd97b9ce92201f4db18a7da95fe6ff8", "b7f53c507a1aa4254b66a883285e27b42d65ea4ea4206fe674e0d03738f52141", "4ae28a44c38edc516e449ddd269b5aa9924d549d763773dcd312b48fe6bb91ab", "c6765d92e540af845b3cbc4caa4f9e9d00d5003a36c9cb548ea79bb14c7e8f66", "f24a8b3144e89b9bececfbf76add87ddefbd19a024a85692026e97f3a9911902", "e64b185c149cb523d13cb46ea3911e2c0595b6f10ae86e6a14b15e8d45c0cdcb", "cb58bf466675be9e11cfb404503cb122514f47b9708d033e381f28a60535812c", "80f88566fda41ebc1b4e35d89748a804740bba0d03049c33c536cffd5e0491e2", "4a36cc607ca5c2acc536510fd1b0ddd43a9403dac168d2420d474611909ed9e6", "89caa1568fcff162086dae91e6bd34fd04facba50166ebff800d45a999d0be8b", "188c72f995ebd5e1e8d0e3b9d34eeeec2ec95d4d0fee30d2ea0f317ab1596eef", "e326c1b9e61cca6823300158e55381c6951b09d2327a89a8d841539cad3b4df3", "4da33c7fe62f71962913d7b40ff76aff9f1586e57db707b3d6b88162c051f402", "ff44e502bd5ea36e17b3fc39b480e65971b36002f27fb441e4acadd6bf604a20", "b7980f64f892d70b1cd72a8c80f8319f50c3c410aba4e4bc63fd6494bcb4f313", "480fae3bdc2604cba846779dd7dced95b3ce036bdef629ded247771a2e4d5d58", "348aea633c99e5f6a0ac7b850961be0a145a35678e5bd074b4852f7a2419f518", "1c53dffcb4c474a2b08708609466e7d234d6d51139b6532af54fac5bb8d37415", "b37ec923451dd15a0f68df0b392b0f1b243fe50c709de9e574ac14cf6fabdd53", "f2814a4b3796fb44045c33b9d0d9972bf40478e5bc74b587486900c6cfa02f3d", "5f1a027f1c1468f93671a4c7fc7b5da00a3c559a9116f5417baa6c1f89550d9f", "8b73d7aa8bb8db8a9ecbf9f713934fbbb5caf4745d7a61a6f34a100c4d84fd9d", "9b9ba722b314febfc44919551a03dde1539f115333183c2cb5e74b8e644ba5b3", "568b4b868b225f06bb34da0dc23603c9dedccc2b319353407c814983d5322563", "5ecad303475e180f8879871d8571d1a7eeb99e0b3c63cc77fdd02cb9b8c51211", "d5b1214f1817a16b2bc8a76daa48c9a3c5af0e411cf4f0c17b0e364d437a454b", "5f0ff1fd6ca89a0ddd3178e023dea8f79ff3c3f3d8ff7900378eb014e83ed326", "40c6fa38e44e00d8cf113d0a079cd46f8b7654331f12e50d2af5a9f1ddc6d266", "3a34cd3a3221d83a1cca8913b2afbb5b780027d48b44d3ce15dfe4a402064871")
